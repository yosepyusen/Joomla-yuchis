var InputSelectLayout=api.InputSelectLayout=extendReactClass('MixinInput',{getInitialState:function(){return{value:this.props.value,new_layout:''};},render:function(){var classContainer='row layout-selector',layouts=[],className,keyName;for(var layout in this.props.form.props.rel.editor.config.prebuilds){className='thumbnail '+(layout==this.state.value?'selected':'');keyName='preview_'+layout;if(this.props.form.props.rel.editor.config.prebuilds[layout].settings){var label=this.props.form.props.rel.editor.config.prebuilds[layout].label;if(this.props.control.action=='save'){label=React.createElement('div',{className:'form-check form-check-inline mb-0'},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'radio',name:this.props.setting,value:layout,checked:layout==this.state.value?true:false,onClick:this.select,className:'form-check-input'}),label));}layouts.push(React.createElement('div',{className:'layout-item float-left'},React.createElement('a',{href:'#',onClick:this.select,className:className,'data-value':layout},React.createElement(api.PaneLayoutPreview,{key:this.props.form.props.rel.editor.props.id+'_'+keyName,ref:keyName,data:this.props.form.props.rel.editor.config.prebuilds[layout].settings,parent:this,editor:this.props.form.props.rel.editor}),React.createElement('div',{className:'caption clearfix'},label,React.createElement('a',{href:'#',onClick:this.remove,className:'float-right','data-value':layout},React.createElement('i',{className:'fa fa-trash'}))))));}}var input=null;if(this.props.control.action=='save'){input=React.createElement('div',{className:'row new-layout'},React.createElement('div',{className:'col-12 px-0'},React.createElement('div',{className:'form-check form-check-inline mb-1'},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'radio',name:this.props.setting,value:this.state.new_layout,checked:this.state.new_layout==this.state.value?true:false,onClick:this.select,className:'form-check-input'}),api.Text.parse('new-layout'))),React.createElement('div',{className:'form-group'},React.createElement('input',{type:'text',name:this.props.setting,value:this.state.new_layout,className:'form-control',placeholder:api.Text.parse('prebuilt-layout-name'),onChange:this.select}))));}if(!layouts.length&&this.props.control.action!='save'){classContainer+=' empty-prelayout';}return React.createElement('div',{ref:'wrapper'},React.createElement('div',{className:classContainer},React.createElement('div',{className:'layout-list'},React.createElement('input',{ref:'field',type:'hidden',name:this.props.setting,value:this.state.value,onChange:this.change}),!layouts.length&&this.props.control.action!='save'?api.Text.parse('no-pre-layout'):layouts)),input);},initActions:function(){api.__parent__();setTimeout(function(){if(!this.refs.wrapper){return;}var previews=this.refs.wrapper.querySelectorAll('.preview-layout'),preview_css,width=0,height=0;if(!previews.length){this.refs.wrapper.querySelector('.layout-list').style.width='100%';return;}for(var i=0;i<previews.length;i++){if(height<previews[i].offsetHeight){height=previews[i].offsetHeight;}}for(var i=0;i<previews.length;i++){previews[i].style.height=height+'px';preview_css=window.getComputedStyle(previews[i].parentNode.parentNode);width+=previews[i].parentNode.parentNode.offsetWidth+parseInt(preview_css.getPropertyValue('margin-left'))+parseInt(preview_css.getPropertyValue('margin-right'));}api.Event.trigger(this.props.form,'FormRendered');}.bind(this),1);},select:function(event){event.preventDefault();var target=event.target,value=this.state.value;if(target.nodeName=='INPUT'){value=target.value;if(target.type=='text'){this.state.new_layout=value;}}else{while(target.nodeName!='A'&&target.nodeName!='BODY'){target=target.parentNode;}value=target.getAttribute('data-value');}this.change(this.props.setting,value);},remove:function(event){event.preventDefault();event.stopPropagation();var target=event.target;while(target.nodeName!='A'&&target.nodeName!='BODY'){target=target.parentNode;}var server=this.props.form.props.rel.editor.config.url+'&action=remove&layout_name='+target.getAttribute('data-value');target.firstElementChild.className='fa fa-circle-o-notch fa-spin';api.Ajax.request(server,function(req){var response=req.responseJSON;target.firstElementChild.className='fa fa-trash';if(response.type=='success'){delete this.props.form.props.rel.editor.config.prebuilds[target.getAttribute('data-value')];this.forceUpdate();}else{bootbox.alert(response.data);}}.bind(this));}});