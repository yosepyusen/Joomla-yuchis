/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
(function(){var t={readOnly:1,exec:function(n){var t=n.editable(),f=n.config.versionsURL||t.getCustomData("versionsURL"),i=null,e=null,o,s;if(n.elementMode==CKEDITOR.ELEMENT_MODE_INLINE){var h=t.getCustomData("itemId"),r="com_content.content",u=t.getCustomData("itemType");context=t.getCustomData("context");typeid=0;u=="module"?(r="com_modules.custom",typeid=t.getCustomData("modTypeId")):u=="category"?(typeid=n.config.versionsCategoryTypeId||n.config.versionsTypeId,r=n.config.categoryTypeAlias||n.config.typeAlias):(typeid=n.config.versionsTypeId,r=n.config.typeAlias,u in n.config.VersionsTypeMap&&(typeid=n.config.VersionsTypeMap[u],r=n.config.VersionsElement+"."+u));f=f.replace(/\[ITEM_ID\]/,h).replace(/\[TYPE_ID\]/,typeid).replace(/\[ITEM_TYPE\]/,r);i=CKEDITOR.document.getById("sbox-window");i&&(e=CKEDITOR.document.getById("sbox-overlay"),n.focusManager.add(i,1),n.focusManager.add(e,1))}if(o=f,jQuery.fn.squeezeBox?jQuery.fn.squeezeBox({handler:"iframe",size:{x:800,y:500},url:o},!0):SqueezeBox.open(null,{handler:"iframe",size:{x:800,y:500},url:o}),n.elementMode==CKEDITOR.ELEMENT_MODE_INLINE)if(s=function(){i&&(n.focusManager.remove(i,1),n.focusManager.remove(e,1))},jQuery.fn.squeezeBox)jQuery(ARK.squeezeBox).on("onClose",function(){s();jQuery(ARK.squeezeBox).off("onClose")});else SqueezeBox.addEvent("onClose",function(){s();this.removeEvents("onClose")})}},n="versions";CKEDITOR.plugins.add(n,{icons:"versions",hidpi:!1,init:function(i){var u=i.element,f=u.getAttribute("data-itemType"),e=i.config.typeAlias,r;(e||i.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE)&&(f!="module"||i.config.enableModuleHistory)&&(r=i.addCommand(n,t),r.modes={wysiwyg:1},i.ui.addButton&&i.ui.addButton("Versions",{label:"Versions",command:n}))}})})()