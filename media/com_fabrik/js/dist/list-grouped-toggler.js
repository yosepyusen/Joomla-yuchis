/*! Fabrik */

define(["jquery"],function(n){return new Class({Implements:Options,options:{collapseOthers:!1,startCollapsed:!1,bootstrap:!1},initialize:function(t,e){var s,o,i,a;"null"!==typeOf(t)&&(this.setOptions(e),this.container=t,this.toggleState="shown",this.options.startCollapsed&&this.options.isGrouped&&this.collapse(),t.addEvent("click:relay(.fabrik_groupheading a.toggle)",function(t){if(!t.rightClick)return t.stop(),t.preventDefault(),this.options.collapseOthers&&this.collapse(),o=t.target.getParent(".fabrik_groupheading"),i=this.options.bootstrap?o.getElement('*[data-role="toggle"]'):o.getElement("img"),a=i.retrieve("showgroup",!0),s=o.getNext()&&o.getNext().hasClass("fabrik_groupdata")?o.getNext():o.getParent().getNext(),a?n(s).hide():n(s).show(),this.setIcon(i,a),a=!a,i.store("showgroup",a),!1}.bind(this)))},setIcon:function(t,e){if(this.options.bootstrap){var s=t.get("data-expand-icon"),o=t.get("data-collapse-icon");e?(t.removeClass(s),t.addClass(o)):(t.addClass(s),t.removeClass(o))}else t.src=e?t.src.replace("orderasc","orderneutral"):t.src.replace("orderneutral","orderasc")},collapse:function(){n(this.container.getElements(".fabrik_groupdata")).hide();var t=this.options.bootstrap?"i":"img",e=this.container.getElements(".fabrik_groupheading a "+t);0===e.length&&(e=this.container.getElements(".fabrik_groupheading "+t)),e.each(function(t){t.store("showgroup",!1),this.setIcon(t,!0)}.bind(this))},expand:function(){n(this.container.getElements(".fabrik_groupdata")).show();var t=this.container.getElements(".fabrik_groupheading a img");0===t.length&&(t=this.container.getElements(".fabrik_groupheading img")),t.each(function(t){t.store("showgroup",!0),this.setIcon(t,!1)}.bind(this))},toggle:function(){"shown"===this.toggleState?this.collapse():this.expand(),this.toggleState="shown"===this.toggleState?"hidden":"shown"}})});